<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>David Fornborg</title>
        <link>https://dfornis.github.io/dfornis/</link>
        <description>Recent content on David Fornborg</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Wed, 14 Jun 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://dfornis.github.io/dfornis/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Ex-post policy evaluation with the synthetic control method</title>
        <link>https://dfornis.github.io/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/</link>
        <pubDate>Wed, 14 Jun 2023 00:00:00 +0000</pubDate>
        
        <guid>https://dfornis.github.io/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/</guid>
        <description>&lt;img src="https://dfornis.github.io/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/background.png" alt="Featured image of post Ex-post policy evaluation with the synthetic control method" /&gt;&lt;h3 id=&#34;introduction&#34;&gt;Introduction&lt;/h3&gt;
&lt;p&gt;The randomized controlled experiment is a powerful tool for researchers seeking to establish causal relationships between interventions and outcomes. However, in the context of social science and policy research, these experiments can be expensive, impractical, and often ethically questionable to run. Imagine, for example, a country that randomly assigns its regions into treatment and control groups when implementing criminal justice reform, aiming to determine the effectiveness of the change, all else equal. While such an approach might intrigue a few scientists, it would rightly incite outrage among the general population. Up until recently, quantitative social scientists resorted to running simple OLS regressions on observational data - reporting correlations as the primary result. This has changed with the introduction of methods that allow researchers identify random assignment of treatment in existing data that. Through a bit of creativity, these techniques enable the construction of artificial treatment and control groups without running an actual experiment.&lt;/p&gt;
&lt;p&gt;The collective effect of the introduction of these models has been dubbed a &amp;lsquo;credibility revolution&amp;rsquo; in economics, and has motivated a shared Nobel prize. Guido Imbens, one of the main forces behind these methods, has described a late comer to the group - the synthetic control method - as “arguably the most important innovation in the policy evaluation literature in the last 15 years” (Athey &amp;amp; Imbens, 2017). In this text, I will provide a practical example of how this method can be applied on a real and current policy case from the energy policy sector. The text is concise write up of parts of the evaluation plan I helped develop for Sweden&amp;rsquo;s evaluation of its excise tax exemption for high-blended biofuels, as requested by the European Commission. It also provides an implementation on actual data with preliminary results.&lt;/p&gt;
&lt;h3 id=&#34;the-synthethic-control-method&#34;&gt;The synthethic control method&lt;/h3&gt;
&lt;p&gt;The method was developed in a series of papers (Abadie &amp;amp; Gardeazabal 2003, and Abadie, Diamond &amp;amp; Hainmueller 2010) and has become an established method for policy evaluations in case studies with one treated unit. Its first policy application was on proposition 99 - an increase of the excise tax on tobacco products in California - by testing its impact on smoking.  Politics are not designed around the conditions of randomly controlled trials, meaning that there were no &amp;ldquo;control California&amp;rdquo; available that didn&amp;rsquo;t receive the treatment while also sharing California&amp;rsquo;s other characteristics. As such, there was no obvious way to estimate the &lt;em&gt;causal&lt;/em&gt; effect of the legislation, all else equal. The synthetic control method solves this rather elegantly. It offers an algorithmic approach to constructing control groups. For the unit that receives treatment, the control is a weighted average of the untreated units that best predicts the outcome variable in the pre-treatment period for the treated unit. In the post-treatment period, it provides a  counterfactual scenario for the treated unit, as if it had not received treatment. In the case of tobacco legislation, the synthetic control weighs the predictors of smoking (drinking, demographic variables, etc.) from a panel dataset and estimates a synthetic control from donor states that best match the rate of smoking of California, for the years that precede the excise tax change.&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 117; flex-basis: 281px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/prop99_scm1.png&#34; data-size=&#34;856x730&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/prop99_scm1.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/prop99_scm1_hucbcf3913f067f33e646c80f8b59e3f64_68309_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/prop99_scm1_hucbcf3913f067f33e646c80f8b59e3f64_68309_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;856&#34;
				height=&#34;730&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;After the policy intervention (post-treatment), the rate of smoking is allowed to deviate, given that there is an effect. The difference between the rate of smoking in actual California and the synthetic California, in the post-treatment period, is the estimated effect of the excise tax increase on smoking.&lt;/p&gt;
&lt;h3 id=&#34;the-case-of-swedens-excise-tax-exemption&#34;&gt;The case of Sweden&amp;rsquo;s excise tax exemption&lt;/h3&gt;
&lt;p&gt;Sweden introduced an excise tax exemption for high-blended and pure biofuels in two steps, first by removing the energy tax in 2003 and then the carbon tax in 2008. High-blended biofuels include bioethanol based fuels such as E85 and bio/synthethic diesels such as FAME and HVO. The price at pump is often higher for these fuels than their fossil equivalents, even without excise taxes. This limits the impact on fuels used in the passenger fleet, but makes a large enough difference to incentivize transport and public transit companies into switching. Unlike private drivers, they benefit from the utility of of environmental signaling and the ability to meet carbon emission targets. Ultimately, the goal of incentivizing biofuel use is to reduce carbon emissions from the transport sector.&lt;/p&gt;
&lt;h3 id=&#34;preparations&#34;&gt;Preparations&lt;/h3&gt;
&lt;p&gt;So how should we go about constructing the synthetic control? First, we need to know what comparable countries that are untreated, i.e. that had no excise tax exemption in place, during the studied period.&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 103; flex-basis: 249px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm2_binarycoding.png&#34; data-size=&#34;1042x1002&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm2_binarycoding.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm2_binarycoding_hu3f78cacd98ba6b3efcbffa752746b5cf_115773_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm2_binarycoding_hu3f78cacd98ba6b3efcbffa752746b5cf_115773_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;1042&#34;
				height=&#34;1002&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;We did a binary coding of EU country&amp;rsquo;s excise tax policies instructed by state aid case documents in the European Commission&amp;rsquo;s state aid database. This provided us with a set of untreated countries, that can be used as donors for the synthetic control. The green squares indicate years with treatment. For the next step, the model needs data on predictors for, in this case, carbon emissions from transport per capita as well as the actual outcome variable. We were instructed in choosing predictor variables by Andersson (2019) who uses a synthetic control model to estimate the effect of the original introduction of a carbon tax on transport fuels in 1990. The actual data on predictors was obtained from The World Bank database, and for the outcome variable, we obtained panel data for a large selection of countries for  1990 through 2019 from the Climate Watch carbon emissions database.&lt;/p&gt;
&lt;p&gt;First, let&amp;rsquo;s compare Sweden&amp;rsquo;s carbon emissions from transport to that of other country&amp;rsquo;s emissions in our dataset.&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 107; flex-basis: 258px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm3_noweights.png&#34; data-size=&#34;1252x1164&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm3_noweights.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm3_noweights_hu5076d4304f6c23db482684e008eae8d2_250685_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm3_noweights_hu5076d4304f6c23db482684e008eae8d2_250685_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;1252&#34;
				height=&#34;1164&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s clear that other, but not all, countries in this group experienced falling carbon emissions from transport in the late 2000&amp;rsquo;s and on. A simple explanation is that all countries follow the EU Renewable Energy Directive and similar directives that preceded it and their dictated biofuel targets for the transport sectors, pursuing different policy tools for this purpose. For example, some applied obligatory blending quotas for biofuels in gasoline and diesel. The discrepancy in emissions is quiet large, both in absolute terms and in rate of change. It seems like there are confounding factors that muddle our ability to single out the effect of a single policy intervention, such as an excise tax change. Further, underlying factors such as road networks, GDP, fuel taxes and more make it hard to find a suitable control country, similar to Sweden but without the excise tax change, and with all else equal. Using the average carbon emissions from transport of all untreated countries, as a control, wouldn&amp;rsquo;t help control for confounders and serves as a poor counterfactual to Sweden.&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 182; flex-basis: 437px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm4_average.png&#34; data-size=&#34;1320x724&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm4_average.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm4_average_huf3398b14a6c00885d7db211100c97582_98448_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm4_average_huf3398b14a6c00885d7db211100c97582_98448_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;1320&#34;
				height=&#34;724&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;But what if, instead of an average, we could apply weights to these countries, as determined by outcome and predictor variables, in order to create a synthetic control with a better fit. Having the lines fit, in the pre-treatment period, would indicate that both observed and unobserved confounding variables are controlled for.&lt;/p&gt;
&lt;h3 id=&#34;estimating-the-weights&#34;&gt;Estimating the weights&lt;/h3&gt;
&lt;p&gt;The synthetic control is constructed by solving an optimization problem, resulting in a set of weights. It&amp;rsquo;s an optimization problem that seeks to minimize the sum of the absolute differences between the outcome variable for the treated unit (Sweden) and the donor countries.&lt;/p&gt;
&lt;p&gt;The first component is a vector of the average of the predictor variables for the treated unit over the pre-intervention periods $T_0$ given by:&lt;/p&gt;
&lt;p&gt;$$X_1 = \frac{1}{T_0}   \sum_{t=1}^{T_0} x_1(t)$$&lt;/p&gt;
&lt;p&gt;The second component is a matrix of the average of the predictor variables for each potential control unit over the pre-intervention periods:&lt;/p&gt;
&lt;p&gt;$$X_0 = \frac{1}{T_0} \sum_{t=1}^{T_0} x_{0}(t)$$&lt;/p&gt;
&lt;p&gt;And the optimization problem can be defined as:&lt;/p&gt;
&lt;p&gt;$$\min_W \quad || X_1 - X_0 W ||$$ $$ \text{subject to } W \geq 0, \quad \sum_{j=1}^{J} W_j = 1$$&lt;/p&gt;
&lt;p&gt;Here, W is a vector of weights for the control units that minimizes the difference between the treated unit and the synthetic control unit in the pre-intervention period. Each weight in W corresponds to one control unit (one country in this case). The constraints that W ≥ 0 and Σ W = 1 ensure that the weights are non-negative and sum to 1.&lt;/p&gt;
&lt;p&gt;The predictor variable weights are implicitly and recursively determined in this process, so as to minimize the difference between the outcome variable for Sweden and the synthetic control.&lt;/p&gt;
&lt;p&gt;Here are the predictor values that I obtained in this test run:&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 420; flex-basis: 1008px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm5_weights_predictors.png&#34; data-size=&#34;924x220&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm5_weights_predictors.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm5_weights_predictors_hu35b0e37afd63f8e0dd0cb8444f1c6f3f_61160_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm5_weights_predictors_hu35b0e37afd63f8e0dd0cb8444f1c6f3f_61160_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;924&#34;
				height=&#34;220&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;We can see that it optimized for a close match between Sweden (treated) and the synthetic control (untreated) in terms of diesel price, passenger cars per 1000 inhabitants and previous carbon emissions from transport, indicative of that these were strong predictors of the outcome variable.&lt;/p&gt;
&lt;p&gt;In terms of country weights, I obtained the following:&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 114; flex-basis: 275px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm6_weights_units.png&#34; data-size=&#34;372x324&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm6_weights_units.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm6_weights_units_hu5319b6abe03509fae6521491a90d9609_48789_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm6_weights_units_hu5319b6abe03509fae6521491a90d9609_48789_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;372&#34;
				height=&#34;324&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;The algorithm determined that France, Finland and Norway were the most suitable donor countries for the synthetic control.&lt;/p&gt;
&lt;h3 id=&#34;results&#34;&gt;Results&lt;/h3&gt;
&lt;p&gt;After the synthetic control is constructed, we compare the outcome variable for the treated unit and the untreated synthetic control during the post-intervention period. Any difference between these two could be attributed to the treatment. Granted that the synthetic control has a good fit with the actual outcome for Sweden.&lt;/p&gt;
&lt;p&gt;In terms of fit, we went from the average of all countries to the weighted synthetic control:&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 182; flex-basis: 437px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm4_average.png&#34; data-size=&#34;1320x724&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm4_average.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm4_average_huf3398b14a6c00885d7db211100c97582_98448_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm4_average_huf3398b14a6c00885d7db211100c97582_98448_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;1320&#34;
				height=&#34;724&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;
&lt;figure style=&#34;flex-grow: 179; flex-basis: 430px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm7_estimate.png&#34; data-size=&#34;1240x692&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm7_estimate.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm7_estimate_hu799727e383a5b4b7f9f1666b4188e2e2_73603_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/ex-post-policy-evaluation-with-the-synthetic-control-method/scm7_estimate_hu799727e383a5b4b7f9f1666b4188e2e2_73603_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;1240&#34;
				height=&#34;692&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&#34;discussion&#34;&gt;Discussion&lt;/h3&gt;
&lt;p&gt;We can see that the synthetic control provides a decent but not perfect fit in the pre-treatment periods. While imperfect, it does a better job than the average at controlling for parts of the variation that stems from covariates such as GDP, diesel price, and passenger car density, as well as unobserved variables. In the post-treatment period, we observe a gradual divergence between the actual carbon emissions for Sweden and the synthetic control which provides us with a counterfactual scenario for the development of carbon emissions from transport had Sweden not implemented an excise tax policy change.&lt;/p&gt;
&lt;p&gt;This post offers a basic implementation of a synthetic control model applied to a real and timely policy case. Despite its imperfect execution, the post aims to demonstrate the model&amp;rsquo;s potential and its relevance for future policy research.&lt;/p&gt;
&lt;p&gt;Note: this implementation was done in R, primarily with the Synth library.&lt;/p&gt;
&lt;h3 id=&#34;references&#34;&gt;References&lt;/h3&gt;
&lt;p&gt;Abadie A, Diamond A, and Hainmueller J. 2010. Synthetic Control Methods for Comparative Case Studies: Estimating the Effect of California’s Tobacco Control Program. &lt;em&gt;Journal of the American Statistical Association&lt;/em&gt;, 105 (490): 493.&lt;/p&gt;
&lt;p&gt;Abadie A, and Gardeazabal J. 2003. The Economic Costs of Conflict: A Case Study of the Basque Country. &lt;em&gt;American Economic Review&lt;/em&gt;, 93 (1):113–32.&lt;/p&gt;
&lt;p&gt;Andersson, J. 2019. Carbon Taxes and CO2 Emissions: Sweden as a Case Study. &lt;em&gt;American Economic Journal: Economic Policy&lt;/em&gt;, 11 (4): 1-30.&lt;/p&gt;
&lt;p&gt;Athey, S, and Guido, I. 2017. The State of Applied Econometrics: Causality and Policy Evaluation. &lt;em&gt;Journal of Economic Perspectives&lt;/em&gt;, 31 (2): 3-32.&lt;/p&gt;
</description>
        </item>
        <item>
        <title>What makes a plot go (semi)-viral?</title>
        <link>https://dfornis.github.io/dfornis/p/what-makes-a-plot-go-semi-viral/</link>
        <pubDate>Mon, 12 Sep 2022 00:00:00 +0000</pubDate>
        
        <guid>https://dfornis.github.io/dfornis/p/what-makes-a-plot-go-semi-viral/</guid>
        <description>&lt;img src="https://dfornis.github.io/dfornis/p/what-makes-a-plot-go-semi-viral/bostadsmarknad_en_bw.png" alt="Featured image of post What makes a plot go (semi)-viral?" /&gt;&lt;h3 id=&#34;background&#34;&gt;Background&lt;/h3&gt;
&lt;p&gt;How long is the wait for a rental apartment in Stockholm? It&amp;rsquo;s an engaging question in the spotlight of both politics and daily life in the Swedish capital. In light of a recent surge in news articles about how young swedes struggle to enter the housing market, I took a look at data provided by Stockholms Bostadskö - Stockholm&amp;rsquo;s sole distributor of rental apartments. It tells a story about a deteriorating rental market with a rapidly growing wait time for apartments (Swedes queue for apartments: Soviet style). I recently found the time to send them an email and request data going back 10 years.&lt;/p&gt;
&lt;h3 id=&#34;the-plot&#34;&gt;The plot&lt;/h3&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 116; flex-basis: 279px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/what-makes-a-plot-go-semi-viral/bostadsmarknad_en_bw.png&#34; data-size=&#34;1500x1290&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/what-makes-a-plot-go-semi-viral/bostadsmarknad_en_bw.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/what-makes-a-plot-go-semi-viral/bostadsmarknad_en_bw_hu31aecfb434fea470d7b7e4694eb4f9ac_103821_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/what-makes-a-plot-go-semi-viral/bostadsmarknad_en_bw_hu31aecfb434fea470d7b7e4694eb4f9ac_103821_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;1500&#34;
				height=&#34;1290&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Visualizing the data, I was struck by how the distribution of the number of years people wait for their apartments has shifted to the right. In another thread on this forum, a contributor had suggested that anecdotal experiences of longer wait times are imagined. &amp;ldquo;It has always been like this and every generation rediscovers the dysfunctional nature of the rental market,&amp;rdquo; his or her sentiment echoed. Looking at the data, I knew that this wasn&amp;rsquo;t true: there had been a dramatic shift for the worse in less than ten years. I use a bar plot to capture this change, colorizing the years of 2010 and 2019 to emphasize the shift. I also want to provide viewers with data for the intermittent years. Shown in a gray scale, the intermittent bars don&amp;rsquo;t obfuscate the two colorized distributions and provide more information to curious viewers.&lt;/p&gt;
&lt;h3 id=&#34;delivery&#34;&gt;Delivery&lt;/h3&gt;
&lt;p&gt;As is often the case in a different subreddit, r/dataisbeautiful, a visualization can garner an audience by itself if it&amp;rsquo;s a map or if it&amp;rsquo;s an animated plot. My experience however is that a more technical plot ideally should be accompanied by a story or a striking fact. To this effect, the title of my post contains information that is deducible from the plot but not immediately available from looking at it. The title of my post states that, &amp;ldquo;In 2010 65% of applicants attained their rental apartment within 6 years of waiting. In 2019, this number had fallen to 11.7%.&amp;rdquo; This is a striking way to describe the cumulative distributional shift with data that is available in the visualization. It&amp;rsquo;s releatable, considering that Swedes think of six years as a reasonable time to wait for an apartment, and it instructs the viewer of what kind of information one can obtain from looking at the plot.&lt;/p&gt;
&lt;p&gt;20,000 might not make the bar for going viral on Tik Tok. But these are 20,000 politically interested Swedish members of a subreddit. Why did this plot strike a chord with its users? A pattern emerges from surveying the topics  that tend to garner upvotes and comments from visitors to this subreddit. Inflation, electricity prices, the housing market, corruption, petty crime such as theft, and growing inequality are topics that garner the most attention. They are political and topical while simultaneously impacting the quality of life of its users. Dysfunctional housing and rental markets are issues that many westerners find themselves navigating as young adults. It affects their quality of life in a tangible and often negative way. Data, effectively communicated, that affirm the personal experience of not being able to attain a rental apartment, is engaging. A plot that describes this reality is not only saying: &amp;ldquo;please worry about this&amp;rdquo;, but it also affirms the lived experience of the viewer.&lt;/p&gt;
&lt;h3 id=&#34;summary&#34;&gt;Summary&lt;/h3&gt;
&lt;p&gt;To summarize, these are ingredients that I believe helps a more technical plot garner a large audience:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Data that connects with the viewer on a personal level&lt;/li&gt;
&lt;li&gt;Data that confirms (or contradicts (both are probably engaging)) the lived experience&lt;/li&gt;
&lt;li&gt;Data that signals that someone&amp;rsquo;s status should decrease (politicians in this case) or increase. This is a Tyler Cowen-esque speculation&lt;/li&gt;
&lt;li&gt;Effectively communicates a shift in time or a discrepancy between groups&lt;/li&gt;
&lt;li&gt;Delivered with a story or a striking fact that is deducible from the visualized data&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>Data visualizations of 2021</title>
        <link>https://dfornis.github.io/dfornis/p/data-visualizations-of-2021/</link>
        <pubDate>Tue, 05 Apr 2022 00:00:00 +0000</pubDate>
        
        <guid>https://dfornis.github.io/dfornis/p/data-visualizations-of-2021/</guid>
        <description>&lt;img src="https://dfornis.github.io/dfornis/p/data-visualizations-of-2021/CCA_line_header.png" alt="Featured image of post Data visualizations of 2021" /&gt;&lt;p&gt;While initially hesitant, owing to a sense that I would rather be involved in actual research, visualizing data turned out to be a creative outlet in the midst of more heavy data wrangling and theoretical work.&lt;/p&gt;
&lt;p&gt;All visualizations were made in R with ggplot2.&lt;/p&gt;
&lt;h2 id=&#34;climate-adaption&#34;&gt;Climate adaption&lt;/h2&gt;
&lt;p&gt;The first set of visualizations were made from a large panel dataset on the climate adaption activities of international organizations, developed for a &lt;a class=&#34;link&#34; href=&#34;http://su.diva-portal.org/smash/record.jsf?pid=diva2%3A1582782&amp;amp;dswid=343&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PHD thesis&lt;/a&gt; by Ece Kural. A lesson I drew from this was to include less text in the subtitle.&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 131; flex-basis: 316px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_line.png&#34; data-size=&#34;1926x1461&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_line.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_line_hu4f61fb1762d875ad2e8199c40fa4d708_305517_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_line_hu4f61fb1762d875ad2e8199c40fa4d708_305517_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;1926&#34;
				height=&#34;1461&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;This simple line graph of aggregated values by region was complemented by a facet of all organizations, maintaining some overview and comparability while displaying a lot of data in one visualization.&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 129; flex-basis: 311px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_facet.png&#34; data-size=&#34;2000x1539&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_facet.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_facet_hu2aabd817aa257b326d3fabad859e5f0e_750273_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_facet_hu2aabd817aa257b326d3fabad859e5f0e_750273_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;2000&#34;
				height=&#34;1539&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Finally I tapped into the animated graph craze with a gif. I didn&amp;rsquo;t manage to iron out all the kinks before time was better invested in other projects.&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 123; flex-basis: 295px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_beeswarm_8_sans.gif&#34; data-size=&#34;1000x813&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_beeswarm_8_sans.gif&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_beeswarm_8_sans_hu4f16fbe9a22d5660749c98d383c9ce8d_3117411_480x0_resize_box.gif 480w, https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/CCA_beeswarm_8_sans_hu4f16fbe9a22d5660749c98d383c9ce8d_3117411_1024x0_resize_box.gif 1024w&#34;
				width=&#34;1000&#34;
				height=&#34;813&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&#34;legitimacy-gap&#34;&gt;Legitimacy gap&lt;/h2&gt;
&lt;p&gt;I was asked to coauthor a background paper with Assoc. Prof. Lisa Dellmuth on the gap in legitimacy beliefs (trust) between citizens and elites towards international organizations. The main research was already done but in order to tailor the paper for the UN Stockholm50+ conference, I got to work with the underlying data in order to analyze it along cross sections that were more relevant to this context.&lt;/p&gt;
&lt;p&gt;Along the way I made a few simple visualizations thematically close to those commonly found in The Economist. By this point I pivoted towards the style and formatting used in business news outlets for increased clarity and readability.&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 129; flex-basis: 311px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/elite_exp_IO_PH.png&#34; data-size=&#34;1600x1231&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/elite_exp_IO_PH.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/elite_exp_IO_PH_huf0a60cf9f0b12bfe1f4fecb74df37cd7_106364_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/elite_exp_IO_PH_huf0a60cf9f0b12bfe1f4fecb74df37cd7_106364_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;1600&#34;
				height=&#34;1231&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&#34;other&#34;&gt;Other&lt;/h2&gt;
&lt;p&gt;It&amp;rsquo;s challenging to communicate findings for multiple variables from panel data along a uniform y or x-scale. Here I used a dot plot and averaged the values with the year 2000 as a divider. This was for book project by Lisa Dellmuth on inequalities within EU regions.&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 149; flex-basis: 359px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/dotplot_unemp_ineq.png&#34; data-size=&#34;1700x1134&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/dotplot_unemp_ineq.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/dotplot_unemp_ineq_hu5efa434b9d51835f1a5c30df4ef12f98_98251_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/data-visualizations-of-2021/dotplot_unemp_ineq_hu5efa434b9d51835f1a5c30df4ef12f98_98251_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;1700&#34;
				height=&#34;1134&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Nowcasting a leading economic indicator in times of uncertainty - with R</title>
        <link>https://dfornis.github.io/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/</link>
        <pubDate>Sun, 31 Jan 2021 00:00:00 +0000</pubDate>
        
        <guid>https://dfornis.github.io/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/</guid>
        <description>&lt;img src="https://dfornis.github.io/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/nicolas-perondi--Ho_obgLFs4-unsplash.jpg" alt="Featured image of post Nowcasting a leading economic indicator in times of uncertainty - with R" /&gt;&lt;hr&gt;
&lt;p&gt;Macroeconomic indicators are traditionally collected with a large lag. This limits their utility in times of high uncertainty. In a pandemic for example, infection rates may accelerate non-linearly (as seen in SIR-models) and are likely to react to variables such as temperature and degree of immunity, many of which remain unknown at the beginning of a pandemic. Nowcasting has been suggested by the Swedish Riksbank (Andersson, Reijer 2015) among others as a tool to make predictions with higher frequency data. Andersson and Reijer use monthly data from surveys, financial markets and similar sources in their nowcasting models to predict Swedish GDP. In this experiment I turned to Google Trends search data to predict movement patterns 1-week-ahead. This time horizon has proven to be relevant in the fast changing landscape of a global pandemic.&lt;/p&gt;
&lt;p&gt;In practical terms, what would the utility be of predicting changes in movement patterns? A sharp drop in movement in public spaces can be categorized as a black swan event for affected parties, whether they are retail stores, public transport companies or government agencies. Predicting a sudden change in movement patterns might provide these parties with an opportunity to prepare for this change. Predicted movement patterns can also be used as a leading economic indicator.&lt;/p&gt;
&lt;h2 id=&#34;theory&#34;&gt;Theory&lt;/h2&gt;
&lt;p&gt;The underlying theory has been advocated for as Narrative Economics by Robert Shiller (2017). But it has featured as a theme in many works without being mentioned by name. Its origins can be traced to the 1930&amp;rsquo;s when Keynes coined the phrase animal spirits to capture a characteristic of human behavior beyond what was imagined in the classical models of economics.&lt;/p&gt;
&lt;p&gt;The assumption is that economic outcomes, to some extent, are a function of the stories and ideas people tell themselves and others. When these stories reach a wide and receptive audience they turn economic behavior into heard behavior. If the narratives that occupy conversations and the minds of people can be measured, they can theoretically be used to predict behavior.&lt;/p&gt;
&lt;h2 id=&#34;data&#34;&gt;Data&lt;/h2&gt;
&lt;p&gt;To capture the narrative component I used an R library called &lt;code&gt;gtrendsR&lt;/code&gt; which runs the API call to Google Trends so that there&amp;rsquo;s no need to cURL it manually. The data is slightly unreliable in the sense that Google provides the amount of hits as an index which is calculated in an unknown black box of magic. The index does however  seem  to measure changes in search trends over a shorter time horizon reasonably well.&lt;/p&gt;
&lt;p&gt;The query used in Google Trends was &lt;code&gt;covid&lt;/code&gt; and &lt;code&gt;virus&lt;/code&gt;. As the interest in Covid-19 rises, people are expected to go online to search for information about the virus or the situation as it unfolds which registers in the index. This variable is countercyclical and should be negatively correlated with movement patterns.&lt;/p&gt;
&lt;p&gt;A procyclical variable was used as well. For this variable my query was &lt;code&gt;snälltåget&lt;/code&gt; and &lt;code&gt;sj&lt;/code&gt; which are the main operators of long distance trains in Sweden. The assumption here is that people on average go online and search for train tickets 1 week ahead of departure. This variable should be positively correlated with movement patterns.&lt;/p&gt;
&lt;p&gt;For data on movement patterns I used Google Mobility Report. It was launched in the infancy of the Covid-19 pandemic to track changes in movement patterns. It calculates changes from the same days baseline categorized by country, sub region and type of location/activity (retail and recreation, parks, homes etc).&lt;/p&gt;
&lt;h2 id=&#34;model&#34;&gt;Model&lt;/h2&gt;
&lt;p&gt;One of the problems with applying a simple linear regression model is that time series data are likely to be autocorrelated which will express itself as covariance between residuals. One way of resolving this is to model the residuals as an ARIMA-process. I ended up with a (1,1,0) process here. So the model used will be a linear regression with ARIMA errors. Sometimes referred to as ARIMAX, where the X denotes an external regressor.&lt;/p&gt;
&lt;p&gt;The equation:&lt;br&gt;
$Y_t = B_1X_{1t} + B_2X_{2t} + n_t$ where $n_t = \phi n_{t-1} + \epsilon _t$ is the ARIMA error term. Notations for differencing are missing.&lt;/p&gt;
&lt;p&gt;In the model, narratives are spread at time t and have an effect on economic behavior at time t+1. Having input variables lagged at t+1 allows the use of an external regressor as fresh input for 1-step-ahead predictions in an ARIMAX model.&lt;/p&gt;
&lt;h2 id=&#34;r-code&#34;&gt;R code&lt;/h2&gt;
&lt;p&gt;Libraries:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;library(tidyverse)
library(gtrendsR) # for Google Trends API calls.
library(fable) # tidyverse compatible replacement of the forecast package.
library(feasts)
library(tsibble)
library(lubridate) # to help with some weekly time series strangeness.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;These were the inputs in the Google Trends API call.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;query &amp;lt;- c(&amp;quot;covid&amp;quot;, &amp;quot;virus&amp;quot;)
query2 &amp;lt;- c(&amp;quot;snälltåget&amp;quot;, &amp;quot;sj&amp;quot;)
date &amp;lt;- c(&amp;quot;2020-03-01 2021-01-15&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I wrote a function which loops along the query vectors and outputs the mean of hits (index of times searched) in a data frame. This allows for easy experimentation with different search queries and explorative data analysis.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;search_se &amp;lt;- data.frame()

search_se_mean &amp;lt;- function(query) {
  for(i in seq_along(search)) {
    print(search[i])
    search_se &amp;lt;- rbind(covid_se,
                      gtrends(keyword = search[i],
                              geo = &amp;quot;SE&amp;quot;,
                              time = date)[[1]])
  }

search_se_mean &amp;lt;- search_se %&amp;gt;%
  mutate(week = yearweek(date, week_start = 1)) %&amp;gt;%
  group_by(week) %&amp;gt;%
  summarise(hits = mean(hits))
}

gtrends_nar &amp;lt;- search_se_mean(query)
gtrends_beh &amp;lt;- search_se_mean(query2)

gtrends_se &amp;lt;- gtrends_nar %&amp;gt;%
  full_join(gtrends_beh, by = &amp;quot;week&amp;quot;, suffix = c(&amp;quot;_nar&amp;quot;, &amp;quot;_beh&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plotted together:&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 175; flex-basis: 420px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/hits_plot.png&#34; data-size=&#34;1800x1027&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/hits_plot.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/hits_plot_hua7ab39595330142847324b445def8aed_103848_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/hits_plot_hua7ab39595330142847324b445def8aed_103848_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;1800&#34;
				height=&#34;1027&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Hits for train travel dropped sharply, as one would expect, and then rebounded over the summer. Hits for the virus jumped up initially but dropped surprisingly fast. Lower levels over the summer was in line with a lower spread of the virus. The index jumped up again in the autumn of 2020, in line with a rising spread of the virus. This inverse relationship between the train travel and virus narrative predictors made intuitive sense and looked promising.&lt;/p&gt;
&lt;p&gt;The next step was to find out if the predictors had any explanatory power on the leading indicator: movement patterns.&lt;/p&gt;
&lt;p&gt;The movement data is available at &lt;a href=&#34;https://www.google.com/covid19/mobility/&#34;&gt;https://www.google.com/covid19/mobility/&lt;/a&gt; I used  the .csv-file for global data and did the filtering for my region of interest in R.
Once it&amp;rsquo;s loaded, the following code will filter for the target country with &lt;code&gt;country_region_code&lt;/code&gt;. I filtered for &lt;code&gt;sub_region_1 = &amp;quot;&amp;quot; &lt;/code&gt; in order to capture data for all of Sweden. The data is then transformed into weeks. Note that  data for &lt;code&gt;retail_and_recreation_percent_change_from_baseline&lt;/code&gt; was used. The movement patterns being predicted are in retail and recreation areas.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gmr_se &amp;lt;- gmr %&amp;gt;%
  mutate(date = as_date(date)) %&amp;gt;%
  filter(country_region_code == &amp;quot;SE&amp;quot;,
         sub_region_1 == &amp;quot;&amp;quot;,
         date &amp;gt;= &amp;quot;2020-03-01&amp;quot; &amp;amp; date &amp;lt;= &amp;quot;2021-01-17&amp;quot;) %&amp;gt;%
  select(date, retail_and_recreation_percent_change_from_baseline) %&amp;gt;%
  mutate(week = yearweek(date, week_start = 1)) %&amp;gt;%
  group_by(week) %&amp;gt;%
  summarise(across(everything(), list(mean))) %&amp;gt;%
  rename(
    &amp;quot;retail&amp;quot; = retail_and_recreation_percent_change_from_baseline_1) %&amp;gt;%
  select(week, retail)

df_se &amp;lt;- gtrends_se %&amp;gt;% # join data sets together
  left_join(gmr_se)

df_se$retail &amp;lt;- df_se$retail + 100 # for potential differencing and log transformations
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Regressions and scatter plots:
&lt;figure style=&#34;flex-grow: 155; flex-basis: 373px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/hits_regressions_plot2.png&#34; data-size=&#34;2100x1350&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/hits_regressions_plot2.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/hits_regressions_plot2_hua328f663b5bd7ed38e00c602276479d8_332050_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/hits_regressions_plot2_hua328f663b5bd7ed38e00c602276479d8_332050_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;2100&#34;
				height=&#34;1350&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Inspecting the plots revealed that there was a linear relationship between the variables. The virus search variable did well with 1 lag, while the train ticket search did better without a lag. This will likely depend a lot on the search queries used and on the reliability of Google&amp;rsquo;s black box data. For the purpose of this experiment I stuck with the theory in order to be able to predict 1-step-ahead and continued with lagged variables.&lt;/p&gt;
&lt;p&gt;Next, preparing the data for model fitting.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;val_weeks &amp;lt;- 15 #15 weeks for validating the models

df_se_index &amp;lt;- df_se %&amp;gt;%
  mutate(index = seq_along(1:nrow(.)),
    type = if_else(index &amp;gt; max(index) - val_weeks,
    &amp;quot;validation&amp;quot;, &amp;quot;training&amp;quot;),
    hits_nar_lag = lag(hits_nar),
    hits_beh_lag = lag(hits_beh))

tsibble_se &amp;lt;- as_tsibble(df_se_index, index = index) # as time series tibble

tsibble_se_train &amp;lt;- tsibble_se %&amp;gt;%
  filter(type == &amp;quot;training&amp;quot;)

tsibble_se_val &amp;lt;- tsibble_se %&amp;gt;%
  filter(type == &amp;quot;validation&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Computing both the TSLM and the ARIMAX (1,1,0) model to see if it makes sense to model the residuals as an ARIMA-process.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;fit_tslm &amp;lt;- tsibble_se_train %&amp;gt;% # fit the model on the training data
  model(TSLM(retail ~ hits_nar_lag + hits_beh_lag))

fc_tslm &amp;lt;- fit_tslm %&amp;gt;% # forecast with the validation data
  forecast(new_data = tsibble_se_val)

fit_arimax &amp;lt;- tsibble_se_train %&amp;gt;%
  model(ARIMA(retail ~ hits_nar_lag + hits_beh_lag + pdq(1, 1, 0)))

fc_arimax &amp;lt;- fit_arimax %&amp;gt;%
  forecast(new_data = tsibble_se_val)

rmse_tslm &amp;lt;- round(accuracy(fit_tslm)[, 4], digits = 2) # extract RMSE

rmse_arimax &amp;lt;- round(accuracy(fit_arimax)[, 4], digits = 2) # extract RMSE

fit_tslm %&amp;gt;% gg_tsresiduals() 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patterns at index &amp;gt; 18 or so didn&amp;rsquo;t look like a white noise-process. This shows up in the ACF plot as well, even though the spikes aren&amp;rsquo;t significant. The takeaway is that modeling the residuals as an ARIMA-process might prove useful.
&lt;figure style=&#34;flex-grow: 107; flex-basis: 256px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_residuals_plot.png&#34; data-size=&#34;1916x1790&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_residuals_plot.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_residuals_plot_hu655848a1b355c501c0d34ca27ceea49f_384107_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_residuals_plot_hu655848a1b355c501c0d34ca27ceea49f_384107_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;1916&#34;
				height=&#34;1790&#34;
				loading=&#34;lazy&#34;
				alt=&#34;TSLM residuals&#34;&gt;
		&lt;/a&gt;
		
		&lt;figcaption&gt;TSLM residuals&lt;/figcaption&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Fitting the ARIMAX-model below. Evaluating the residuals, they looked more like a stationary white noise process. No significant spikes.&lt;/p&gt;
&lt;p&gt;&lt;figure style=&#34;flex-grow: 123; flex-basis: 295px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/arimax_residuals_plot.png&#34; data-size=&#34;904x733&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/arimax_residuals_plot.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/arimax_residuals_plot_hu4f5034fb73b254b14675345864cce34e_62048_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/arimax_residuals_plot_hu4f5034fb73b254b14675345864cce34e_62048_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;904&#34;
				height=&#34;733&#34;
				loading=&#34;lazy&#34;
				alt=&#34;ARIMAX residuals&#34;&gt;
		&lt;/a&gt;
		
		&lt;figcaption&gt;ARIMAX residuals&lt;/figcaption&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Plotting the models and forecasts produced with Fable:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tslm_plot &amp;lt;- 
  tsibble_se %&amp;gt;%
  mutate(color = if_else(type == &amp;quot;training&amp;quot;, &amp;quot;#7e828c&amp;quot;, &amp;quot;#7e828c&amp;quot;)) %&amp;gt;%
  ggplot(aes(x = index, y = retail)) +
  geom_line() +
  autolayer(fc_tslm, alpha = 0.5, color = &amp;quot;#aa332c&amp;quot;) +
  geom_line(aes(color = color), alpha = 0.8) +
  geom_line(aes(y = .fitted, color = &amp;quot;#aa332c&amp;quot;), data = augment(fit_tslm)) +
  labs(
    title = &amp;quot;TSLM model&amp;quot;,
    subtitle = paste0(&amp;quot;RMSE = &amp;quot;, rmse_tslm)) +
  scale_color_identity() 
  
arimax_plot &amp;lt;- 
  tsibble_se %&amp;gt;%
  mutate(color = if_else(type == &amp;quot;training&amp;quot;, &amp;quot;#7e828c&amp;quot;, &amp;quot;#7e828c&amp;quot;)) %&amp;gt;%
  ggplot(aes(x = index, y = retail)) +
  geom_line() +
  autolayer(fc_arimax, alpha = 0.5, color = &amp;quot;#aa332c&amp;quot;) +
  geom_line(aes(color = color), alpha = 0.8) +
  geom_line(aes(y = .fitted, color = &amp;quot;#aa332c&amp;quot;), data = augment(fit_arimax)) +
  labs(
    title = &amp;quot;ARIMAX model&amp;quot;,
    subtitle = paste0(&amp;quot;RMSE = &amp;quot;, rmse_arimax)) +
  scale_color_identity() 
  
grid.arrange(tslm_plot, arimax_plot, nrow = 2)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure style=&#34;flex-grow: 100; flex-basis: 240px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_arimax_forecasts.png&#34; data-size=&#34;2100x2100&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_arimax_forecasts.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_arimax_forecasts_hu4346fcd9ca4674303bb43313d3e76666_400552_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_arimax_forecasts_hu4346fcd9ca4674303bb43313d3e76666_400552_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;2100&#34;
				height=&#34;2100&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m a bit surprised that the fitted TSLM model performed in parity with the ARIMAX model. I think this might vary a lot depending on the data you end up with. Both models do a decent job on the training data. But they both do a poor job at forecasting the sharp drop in movement that occurs at the end of the time series. I should point out that the ARIMAX model is forecasting the AR(1)-process recursively here. Consequently, there is a mean reversion and it looses its effect over time.&lt;/p&gt;
&lt;p&gt;Since I&amp;rsquo;m interested in the 1-step-ahead forecast, I wrote the loop below to capture what that looks like on the validation data. The point here is to capture the direct 1-step-ahead forecast instead of a recursive forecast, and thereby utilize the full potential of the ARIMAX-model.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tsibble_se_loop &amp;lt;- data.frame()
direct_pred &amp;lt;- data.frame()
index &amp;lt;- 15:nrow(tsibble_se)
val_weeks = 1

for(i in index) {
  tsibble_se_loop &amp;lt;- df_se %&amp;gt;%
    mutate(index = seq_along(1:nrow(.)),
           hits_nar_lag = lag(hits_nar),
           hits_beh_lag = lag(hits_beh)) %&amp;gt;%
    as_tsibble(., index = index) %&amp;gt;%
    filter(index &amp;lt; index[i]) %&amp;gt;%
    mutate(type = if_else(index &amp;gt; max(index) - val_weeks,
                          &amp;quot;validation&amp;quot;, &amp;quot;training&amp;quot;))
  
  # Save the training data
  tibble_train_loop &amp;lt;- tsibble_se_loop %&amp;gt;%
    filter(type == &amp;quot;training&amp;quot;)
  
  # Save the validation data
  tibble_val_loop &amp;lt;- tsibble_se_loop %&amp;gt;%
    filter(type == &amp;quot;validation&amp;quot;)
  
  fit_arimax &amp;lt;- tibble_train_loop %&amp;gt;%
    model(ARIMA(retail ~ hits_nar_lag + hits_beh_lag + pdq(1, 1, 0)))
  fc_arimax &amp;lt;- fit_arimax %&amp;gt;%
    forecast(new_data = tibble_val_loop)
  
  fc_arimax &amp;lt;- as_tibble(fc_arimax) %&amp;gt;%
    select(index, .mean)
  
  direct_pred &amp;lt;- rbind(direct_pred, fc_arimax)
}

direct_pred &amp;lt;- as_tsibble(direct_pred, index = index)

arimax_direct_plot &amp;lt;- 
  tsibble_se %&amp;gt;%
  mutate(color = if_else(type == &amp;quot;training&amp;quot;, &amp;quot;#7e828c&amp;quot;, &amp;quot;#7e828c&amp;quot;)) %&amp;gt;%
  ggplot(aes(x = index, y = retail)) +
  geom_line() +
  geom_point(aes(x = index, y = .mean), color = &amp;quot;#aa332c&amp;quot;, fill = &amp;quot;#aa332c&amp;quot;, size = 2, alpha = .8, data = direct_pred) +
  autolayer(direct_pred, alpha = 0.8, color = &amp;quot;#aa332c&amp;quot;)  +
  labs(
    title = &amp;quot;ARIMAX model&amp;quot;,
    subtitle = &amp;quot;with 1-step-ahead direct forecast&amp;quot;) +
  scale_color_identity() +
  theme(
    axis.title.x = element_blank()
  )

grid.arrange(tslm_plot, arimax_plot, arimax_direct_plot,  nrow = 3)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure style=&#34;flex-grow: 100; flex-basis: 240px&#34;&gt;
		&lt;a href=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_arimax_direct_forecasts.png&#34; data-size=&#34;2100x2100&#34;&gt;&lt;img src=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_arimax_direct_forecasts.png&#34;
				srcset=&#34;https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_arimax_direct_forecasts_hu4346fcd9ca4674303bb43313d3e76666_449833_480x0_resize_box_2.png 480w, https://dfornis.github.io/dfornis/dfornis/p/nowcasting-a-leading-economic-indicator-in-times-of-uncertainty-with-r/tslm_arimax_direct_forecasts_hu4346fcd9ca4674303bb43313d3e76666_449833_1024x0_resize_box_2.png 1024w&#34;
				width=&#34;2100&#34;
				height=&#34;2100&#34;
				loading=&#34;lazy&#34;
				&gt;
		&lt;/a&gt;
		
	&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&#34;conclusion&#34;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;The direct 1-step-ahead ARIMAX forecast does a little better than both the TSLM and the ARIMAX recursive forecast at self-correcting for the last drop off in movement. But still, it essentially fails to predict that last drop 1 week ahead. Leaving that aside, the level of predictive power in the model is surprising considering its simplicity. What I take away from this experiment is that with a bit of fine-tuning and perhaps added complexity it is possible to predict a leading economic indicator with high-frequency narrative data.&lt;/p&gt;
&lt;p&gt;The fact that the virus search variable did better with 1 lag as predicted while the train ticket search variable did worse is interesting. It might indicate that people don&amp;rsquo;t plan ahead when traveling by train or that train travel has an added element of spontaneity in times of high uncertainty when there is already a pent up demand for travel.&lt;/p&gt;
&lt;p&gt;For future experiments it would be interesting to explore a machine learning technique with a larger and more varied narrative data set. The statistical rigor offered by conventional techniques are not as relevant in a forecasting model as they are when exploring a casual relationship.&lt;/p&gt;
&lt;h2 id=&#34;references&#34;&gt;References&lt;/h2&gt;
&lt;p&gt;Andersson, Michael K. and Reijer, Ard H.J. (2015), “Nowcasting”, Sveriges Riksbank Economic Review, 2015:1, Sveriges Riksbank, pp. 75-89.&lt;/p&gt;
&lt;p&gt;Shiller, J.R. (2017) Narrative Economics. NBER Working Paper, No. 23075.&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
